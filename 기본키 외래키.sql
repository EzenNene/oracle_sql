-- 부서 테이블

DROP TABLE DEPT;
DROP TABLE EMP;

CREATE TABLE DEPT (
    DEPT_NO NUMBER PRIMARY KEY,         -- 부서번호
    DEPT_NAME VARCHAR2(20) NOT NULL,    -- 부서명
    DEPT_ADDRESS VARCHAR2(100)          -- 부서주소
);

INSERT INTO DEPT VALUES(1, '인사부', NULL);
INSERT INTO DEPT VALUES(2, '연구부', NULL);
INSERT INTO DEPT VALUES(3, '홍보부', NULL);
INSERT INTO DEPT VALUES(4, '개발부', NULL);

SELECT * FROM DEPT;

-- 사원 테이블
CREATE TABLE EMP (
    EMP_NO NUMBER PRIMARY KEY,          -- 사원번호
    EMP_NAME VARCHAR2(20) NOT NULL,     -- 사원명
    DEPT_NO NUMBER NOT NULL,            -- 부서번호
    CONSTRAINT FK_DEPT_NO FOREIGN KEY(DEPT_NO) REFERENCES DEPT(DEPT_NO) -- 제약조건 설정
);

INSERT INTO EMP VALUES (1001, '정소화', 3);
INSERT INTO EMP VALUES (1002, '김용욱', 1);
INSERT INTO EMP VALUES (1003, '고명석', 2);
INSERT INTO EMP VALUES (1004, '김연아', 4);
INSERT INTO EMP VALUES (1005, '강희재', 5);

UPDATE EMP SET DEPT_NO = 3 WHERE EMP_NAME = '정소화';

DELETE FROM DEPT WHERE DEPT_NO = 1;
DELETE FROM EMP WHERE DEPT_NO = 1;
-- 자식이 사용중이므로 무조건 자식 먼저 삭제하고 부모 삭제 해야함

SELECT * FROM EMP;

DROP TABLE EMP;
DROP TABLE DEPT; -- DEPT를 참조하고 있는 테이블을 먼저 삭제해야함
DROP TABLE DEPT CASCADE CONSTRAINTS; -- 강제

--------------------------------------------------------------------------------
--퀴즈
DROP TABLE CLASS;
DROP TABLE STUDENT;

CREATE TABLE CLASS (
    CLASS_NO NUMBER PRIMARY KEY,
    CLASS_NAME VARCHAR2(20)
);

INSERT INTO CLASS VALUES (1001, '수학');
INSERT INTO CLASS VALUES (1002, '국어');

SELECT * FROM CLASS;

CREATE TABLE STUDENT (
    STUDENT_NO NUMBER PRIMARY KEY,
    STUDENT_NAME VARCHAR2(20)
);

INSERT INTO STUDENT VALUES (2001, '정소화');
INSERT INTO STUDENT VALUES (2002, '김용욱');
INSERT INTO STUDENT VALUES (2003, '고명석');

SELECT * FROM STUDENT;

CREATE TABLE CLASS_STUDENT(
    CS_NO NUMBER PRIMARY KEY,
    CLASS_NO NUMBER,
    STUDENT_NO NUMBER,
    
    CONSTRAINT FK_CLASS_NO FOREIGN KEY(CLASS_NO) REFERENCES CLASS(CLASS_NO),
    CONSTRAINT FK_STUDENT_NO FOREIGN KEY(STUDENT_NO) REFERENCES STUDENT(STUDENT_NO)
);

INSERT INTO CLASS_STUDENT VALUES (1, 1001, 2001);
INSERT INTO CLASS_STUDENT VALUES (2, 1002, 2001);
INSERT INTO CLASS_STUDENT VALUES (3, 1001, 2002);
INSERT INTO CLASS_STUDENT VALUES (4, 1002, 2002);
INSERT INTO CLASS_STUDENT VALUES (5, 1002, 2003);


SELECT * FROM CLASS_STUDENT;






